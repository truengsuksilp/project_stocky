{% extends 'base.html' %}

{% block content %}

<!-- TODO: Create Portfolio Button -->
<!-- TODO: Delete Stock Button -->

<article class="profile">
    <!-- Avatar -->
    <section>
        <img src="https://cbsnews1.cbsistatic.com/hub/i/2016/12/14/4b7e3037-b62b-4f21-9e5c-1c181da45a6a/screen-shot-2016-12-14-at-4-25-12-pm.png" alt="avatar">
    </section>

    <!-- Portfolio: Current stocks | Add Stocks | Run Button -->
    {% for portfolio in user.portfolios.all %}  
        <section class="portfolio-list">
            <div class="portfolio-header">
                <h3>{{portfolio.name}}</h3>
                <a href="{% url 'portfolio_update' portfolio.pk %}">
                    <Button type="submit" class="btn btn-warning">Edit</button>
                </a>
            </div>

            {% for stock in portfolio.stocks.all %}
                <div class="stock">
                    <span>
                        <i class="fas fa-exchange"></i>
                        &nbsp
                        {{stock.ticker}}
                    </span>
                    <span>
                        {{stock.price}}
                        {% comment %} &nbsp
                        <a href="{% url 'stock_delete' portfolio.pk stock.pk %}">
                            <i class="fa fa-trash"></i>
                        </a> {% endcomment %}
                    </span>
                    <span>
                        <!-- Delete Stock: Refactored <a> to <form> -->
                        <form action="{% url 'stock_delete' portfolio.pk stock.pk %}" method="POST">
                            {% csrf_token %}
                            <button type=submit class="btn btn-danger button-delete-stock">Delete</button>
                        </form>
                    </span>
                </div>
            {% endfor %}

            <a href="{% url 'stock_create' portfolio.pk %}">
                <Button class="btn btn-secondary stock-add-button">Add Stock</button>
            </a>

            <a href="{% url 'portfolio_delete' portfolio.pk %}">
                <Button class="btn btn-danger stock-add-button">Delete</button>
            </a>

            <a href="{% url 'portfolio_analyze' portfolio.pk %}">
                <Button class="btn btn-primary stock-add-button">Run Analysis</button>
            </a>
        </section>
    {% endfor %}
</article>    

    
{% endblock %}